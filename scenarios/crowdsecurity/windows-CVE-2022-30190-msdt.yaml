type: trigger
name: crowdsecurity/CVE-2022-30190-msdt
description: "Detect CVE-2022-30190 from sysmon events"
filter: |
  evt.Meta.service == 'sysmon' && evt.Parsed.EventID == '1' && 
  Upper(evt.Parsed.Image) endsWith 'MSDT.EXE' && 
  Upper(evt.Parsed.ParentImage) endsWith 'WINWORD.EXE' &&
  (Upper(evt.Parsed.CommandLine) contains 'PCWDIAGNOSTIC' && Upper(evt.Parsed.CommandLine) contains 'IT_REBROWSEFORFILE' && Upper(evt.Parsed.CommandLine) contains 'IT_BROWSEFORFILE')
labels:
  type: rce
  notification: true
  os: windows
  classification:
  - attack.TA0002.T1059.001
  - attack.TA0002.T1203
  target:
  - vendor.microsoft
  - product.msdt
scope:
  type: user_account
  expression: evt.Parsed.User
